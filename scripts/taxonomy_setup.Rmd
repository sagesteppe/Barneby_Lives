---
title: "Barneby Lives!"
author: "steppe"
date: "9/13/2021"
output: html_document
---

```{r}
library(tidyverse)
library(kewr)
library(WorldFlora)
# WFO.remember()
source('functions.R')
```

# the first letter of the genus must be correct, 
# the first three letters of the species must be correct


```{r prepare materials for look up tables, eval = F}

cla <- data.table::fread('../taxonomic_data/WFO_Backbone/classification.txt', na.strings = "")

epiLKPtab <- cla[, c('scientificName', 'specificEpithet', 'infraspecificEpithet', 'verbatimTaxonRank')]
epiLKPtab <- filter(epiLKPtab, is.na(verbatimTaxonRank) | verbatimTaxonRank != "f.")

genLKPtab <- unique(cla, by = 'genus')[taxonomicStatus == 'Accepted','genus'] %>% 
  arrange(genus) %>% 
  mutate(Grp = str_extract(genus, '[A-Z][a-z]{1}'))%>% 
  rename(strings = genus)
speLKPtab <- unique(cla, by = 'specificEpithet')[
  taxonomicStatus == 'Accepted','specificEpithet'] %>% 
  arrange(specificEpithet) %>% 
  mutate(Grp = str_extract(specificEpithet, '[a-z]{3}')) %>% 
  rename(strings = specificEpithet)


spell_check('Penstemon scariosus var. garrettii') # works
spell_check('Penstemen scariosus var. garrettii') # works
spell_check('Penstemen scariosius var garratti') # works
spell_check('Penstemen scariosius ssp garratti') # works
spell_check('Penstemen scariosus') # works


```


```{r}
lapply(c('Cryptantha glomerata', 'Sphenosciadium capitellatum'), powo_searcher)
```




   
